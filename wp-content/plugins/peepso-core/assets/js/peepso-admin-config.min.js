jQuery(function(s){s("input[name=peepso_admin_verbose_tabs]").on("click",_.throttle(function(e,t){var n=s(".ps-label-optional"),a=peepsodata.ajaxurl;this.checked?n.show():n.hide(),t||s.post({url:a,data:{action:"peepso_admin_verbose_tabs",value:+this.checked}})},1e3)).triggerHandler("click",[!0]),s("input[name=peepso_admin_verbose_fields]").on("click",_.throttle(function(e,t){var n=s(".lbl-descript");url=peepsodata.ajaxurl,action="peepso_admin_verbose_fields",this.checked?n.show():n.hide(),t||s.post({url:url,data:{action:action,value:+this.checked}})},1e3)).triggerHandler("click",[!0]),s("input[name=bundle]").on("click",_.throttle(function(e,t){var n=s(".license_status_check"),a=s("input[name=bundle_license]"),i=a.val(),r=this.checked;r?(a.closest(".form-group").show(),s("#field_bundle_message").hide()):(a.closest(".form-group").hide(),s("#field_bundle_message").show()),n.each(function(){var e=s(this).closest("label").next("div.form-field").find("input");r?(e.data("origLicense",e.val()),e.val(i),e.attr("readonly","readonly").css("opacity",.5)):t||(e.removeAttr("readonly").css("opacity",""),e.val(e.data("origLicense")||""))})},100)).triggerHandler("click",[!0]),s("input[name=bundle_license]").add(s(".license_status_check").closest(".form-group").find("input[type=text]")).on("input",function(){var e=this.value.replace(/[^a-zA-Z0-9]/g,"");this.value!==e&&(this.value=e)}),s("input[name=bundle_license]").on("input focus blur",_.throttle(function(e){var t=s(".license_status_check"),n=this.value,a=n.trim(),i=s("input[name=bundle]")[0].checked;n!==a&&(this.value=n=a),i&&t.each(function(){s(this).closest("label").next("div.form-field").find("input").val(n)})},100)),s("input[name=loadmore_enable]").on("click",_.throttle(function(){var e=s("select[name=loadmore_repeat]").closest(".form-group");this.checked?e.show():e.hide()},100)).triggerHandler("click"),s("select[name=notification_ajax_delay_min]").on("change",_.throttle(function(){var e=s("select[name=notification_ajax_delay]"),t=+e.val(),n=+this.value;t<n&&e.val(n)},100)),s("select[name=notification_ajax_delay]").on("change",_.throttle(function(){var e=+s("select[name=notification_ajax_delay_min]").val();+this.value<e&&s(this).val(e)},100)).triggerHandler("change"),s("input[name=brute_force_enable]").on("click",_.throttle(function(){var e=s("select[name=brute_force_max_retries]"),t=s("textarea[name=brute_force_whitelist_ip]"),e=e.closest(".form-group"),t=t.closest(".form-group").next(".clearfix"),t=e.add(t).add(e.nextUntil(t));this.checked?t.show():t.hide()},100)).triggerHandler("click"),s(document).ready(function(){s("input[name=site_reporting_enable]").on("click",_.throttle(function(){var e=s(this).closest(".form-group").nextAll(".form-group");this.checked?(e.show(),s("input[name=reporting_notify_email]").triggerHandler("click")):e.hide()},100)).triggerHandler("click"),s("input[name=reporting_notify_email]").on("click",_.throttle(function(){var e=s("textarea[name=reporting_notify_email_list]").closest(".form-group");this.checked?e.show():e.hide()},100)).triggerHandler("click"),s("input[name=site_registration_disabled]").on("click",_.throttle(function(){var e=s("input[name=registration_redirect_wp_to_peepso]"),t=s("input[name=registration_confirm_email_field]"),n=s("input[name=site_registration_enable_ssl]"),n=e.add(t).add(n).closest(".form-group");this.checked?n.hide():n.show()},100)).triggerHandler("click");var r,t,e=s("input[name='avatars_wordpress_only']");function n(){peepso.postJson("adminConfigLicense.check_license",{plugins:t},function(e){var t,n,a,i;if(e.success)for(a in t=e.data&&e.data.valid||{},n=e.data&&e.data.details||{},t)+t[a]?(i='<i class="ace-icon fa fa-check bigger-110" style="color:green"></i>',s("#error_"+a).hide()):(i='<i class="ace-icon fa fa-times bigger-110" style="color:red"></i>',s("#error_"+a).show()),n[a]&&(i=i+"<br/>"+n[a]),r.filter("#"+a).html(i)})}e.length&&e.on("change",function(){s(this).is(":checked")?(s("#field_avatars_peepso_only").fadeOut(500).find("input[name=avatars_peepso_only]").attr("disabled","disabled"),s("#field_avatars_peepso_gravatar").fadeOut(500),s("#field_avatars_wordpress_only_desc").fadeIn(500)):(s("#field_avatars_peepso_only").fadeIn(500).find("input[name=avatars_peepso_only]").removeAttr("disabled"),s("#field_avatars_peepso_gravatar").fadeIn(500),s("#field_avatars_wordpress_only_desc").fadeOut(500))}).trigger("change"),r=s(".license_status_check"),t={},r.length&&(r.each(function(){var e=s(this);t[e.attr("id")]=e.data("plugin-name"),e.closest("label").next("div.form-field").find("input").on("input focus blur",_.throttle(function(e){var t=this.value,n=t.trim();t!==n&&(this.value=n)},500))}),n(),setInterval(function(){n()},3e4));var a,i=s("#reset-check");i.length&&(a=s("#reset-do"),i.on("click",function(){this.checked?a.removeAttr("disabled"):a.attr("disabled","disabled")}),a.on("click",function(e){e.preventDefault(),e.stopPropagation();e=(e=window.location.href).replace("&reset=1","");window.location=e+"&reset=1"}));var o,e=window.location.href.match(/page=(peepso(?:[-_a-z]+)?)(?:&(tab=[-a-z]+))?/i),l="rgba(240,245,250,.7)";e&&((i=s("#toplevel_page_peepso li.current ul.wp-submenu-wrap").find("a[href]")).length&&(o=e[2]?i.filter('[href$="'+e[2]+'"]'):i.eq(0)),i.not(o).css({color:l,fontWeight:"normal"}).on("mouseenter",function(){s(this).css({color:"#00b9eb"})}).on("mouseleave",function(){s(this).css({color:l})}))});var i={};function e(){s("input[type=text].validate").off("keyup.validate").on("keyup.validate",function(){var e,t,n=s(this);t=(e=n).data(),clearTimeout(a),a=setTimeout(function(){("int"===t.ruleType?function(e,t){var n=+e.val(),a=e.attr("name");t.ruleMin=+t.ruleMin,t.ruleMax=+t.ruleMax,t.ruleMin&&n<t.ruleMin||t.ruleMax&&n>t.ruleMax?(r(e,t),i[a]=!0):(o(e),i[a]=!1,delete i[a]);l()}:"email"===t.ruleType?function(e,t){var n=e.val();/^([*+!.&#$Â¦\'\\%\/0-9a-z^_`{}=?~:-]+)@(([0-9a-z-]+\.)+[0-9a-z]{2,15})$/i.test(n)?(o(e),i[name]=!1,delete i[name]):(r(e,t),i[name]=!0);l()}:function(e,t){var n=e.val(),a=e.attr("name");t.ruleMinLength=+t.ruleMinLength,t.ruleMaxLength=+t.ruleMaxLength,t.ruleMinLength&&n.length<t.ruleMinLength||t.ruleMaxLength&&n.length>t.ruleMaxLength?(r(e,t),i[a]=!0):(o(e),i[a]=!1,delete i[a]);l()})(e,t)},300)}).trigger("keyup")}var a=!1;function r(e,t){e.hasClass("error")||(t.ruleMessage&&(e.next(".validate-error").length||s(['<div class="validate-error tooltip bottom">','<div class="tooltip-arrow"></div>','<div class="tooltip-inner">',t.ruleMessage,"</div></div>"].join("")).insertAfter(e)),e.addClass("error"))}function o(e){e.hasClass("error")&&e.removeClass("error")}var t=!1;function l(){clearTimeout(t),t=setTimeout(n,300)}function n(){var e,t=!1;for(e in i)if(i[e]){t=!0;break}var n=s("#peepso button[type=submit]");t?n.attr("disabled","disabled"):n.removeAttr("disabled")}var c=!1;function p(){clearTimeout(c),c=setTimeout(d,300)}function d(){s("#edit_warning").show()}function u(e){s(".img-landing-page-preview").attr("src",e).show(),s(".btn-lp-img-remove").show(),s(".default-img-selected").hide(),s("#landing_page_image").val(e)}function g(){s("#landing_page_image").val(""),s(".img-landing-page-preview").attr("src",s("#landing_page_image_default").val()),s(".btn-lp-img-remove").hide(),s(".default-img-selected").show()}function h(){var e=s('[id*="field_wordfilter"]').not("#field_wordfilter_enable");s('[name="wordfilter_enable"]').is(":checked")?e.show():e.hide()}function m(){var e=s('[id*="field_polls"]').not("#field_polls_enable");s('[name="polls_enable"]').is(":checked")?e.show():e.hide()}s(function(){e(),s("#peepso button[type=reset]").on("click",function(){setTimeout(e,100),setTimeout(function(){s("#edit_warning").hide()},1e3)}),setTimeout(function(){s("#peepso").find("input[type=text], textarea").on("keyup",function(){p()}),s("#peepso").find("input[type=checkbox], select").on("change",function(){p()})},1e3)}),s(document).ready(function(){0<s(".inline-select").length&&s(".inline-select").on("click",function(e){s(this).closest("ul").find("a").removeClass("btn-primary"),s(this).closest(".form-group").find('input[type="hidden"]').val(s(this).attr("data-value")),s(this).addClass("btn-primary"),e.preventDefault()});var e=s("input[name='opengraph_enable']");function n(e){s(".img-og-preview").attr("src",e).show(),s(".btn-img-remove").show(),s(".no-img-selected").hide(),s("#opengraph_image").val(e)}function t(){s("#opengraph_image").val(""),s(".img-og-preview").attr("src",""),s(".img-og-preview, .btn-img-remove").hide(),s(".no-img-selected").show()}e.length&&(e.on("change",function(){$selector=s(this).closest(".inside").find('[id*="field_"]').not("#field_opengraph_enable"),s(this).is(":checked")?$selector.fadeIn(500):$selector.fadeOut(500)}).trigger("change"),s("#opengraph_title").after("<p class='text-right'><span class='opengraph_title_counter'></span> Characters</p><p>Depending on where the links will be shared, the title can be cropped to even 40 characters. Keep the title short and to the point.</p>"),s(".opengraph_title_counter").html(s("#opengraph_title").val().length),s("#opengraph_title").on("keyup",function(e){s(".opengraph_title_counter").html(s("#opengraph_title").val().length)}),s("#opengraph_description").after("<p class='text-right'><span class='opengraph_description_counter'></span> Characters</p><p>Depending on where the links will be shared, the description can be cropped to even 200 characters. Keep the description short and to the point.</p>"),s(".opengraph_description_counter").html(s("#opengraph_description").val().length),s("#opengraph_description").on("keyup",function(e){s(".opengraph_description_counter").html(s("#opengraph_description").val().length)})),$og_image_prop='<a class="btn btn-sm btn-info btn-img-og" href="#">Select Image</a> <a class="btn btn-sm btn-danger btn-img-remove" href="#">Remove Image</a><span class="no-img-selected">No image selected</span><img class="img-responsive img-og-preview" src="" />',s("#opengraph_image").after($og_image_prop).hide(),""!=s("#opengraph_image").val()?n(s("#opengraph_image").val()):t(),s(".btn-img-og").on("click",function(e){var t=s(this);wp.media.editor.send.attachment=function(e,t){n(t.url)},wp.media.editor.open(t)}),s(".btn-img-remove").on("click",function(e){t(),e.preventDefault()})}),$lp_image_prop='<a class="btn btn-sm btn-info btn-img-landing-page" href="#">Select Image</a> <a class="btn btn-sm btn-danger btn-lp-img-remove" href="#">Remove Image</a><span class="default-img-selected">Default image selected</span><img class="img-responsive img-landing-page-preview" src="" />',s("#landing_page_image").after($lp_image_prop).hide(),s("#landing_page_image_default").hide(),""!=s("#landing_page_image").val()?u(s("#landing_page_image").val()):g(),s(".btn-img-landing-page").on("click",function(e){wp.media.editor.send.attachment=function(e,t){u(t.url)},wp.media.editor.open()}),s(".btn-lp-img-remove").on("click",function(e){g(),e.preventDefault()}),s(".notice.is-dismissible.peepso-new-plugin").on("click",".notice-dismiss",function(){s.post(ajaxurl,{action:"dismiss_new_plugin_notice"})}),s("form.ps-form").on("submit",function(e){var t=s("textarea[name='wordfilter_keywords']");words=t.val(),str_array=words.split(","),words=[];for(var n=0;n<str_array.length;n++)str_array[n]=str_array[n].replace(/^\s*/,"").replace(/\s*$/,""),str_array[n]&&words.push(str_array[n]);t.val(words.join(", "))}),h(),s('[name="wordfilter_enable"]').on("click",function(){h()}),m(),s('[name="polls_enable"]').on("click",function(){m()})});